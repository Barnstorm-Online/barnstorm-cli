#!/usr/bin/env node

const
  parseArgs = require('minimist'),
  env = require('../lib/environment')()


const argv = parseArgs(process.argv.slice(2), {
  alias: {
    v: 'verbose',
    a: 'all',
    s: 'save',
    h: 'help'
  },
  string: ['_'],
  boolean: ['h', 'a', 's', 'v']
})

if (argv.help) {
  console.log(`
  Description
    Quasars equivalent of UNIX's printenv for Quasar 
  Usage
    $ quasar config
  Options
    --save, -s      Save your current variables to .env file
    --verbose, -v   Print all variables associated with quasar/development
    --all, -a       Equivalent to printenv with quasars added variables
    --help, -h      Displays this message
  `)
  process.exit(0)
}

/**
 * TODO: add checks for valid ENVs and prompt with appropriate errors
 * @example
 * ...
 * if (argv.envVariables[1] === '=') throw new Error('Must use KEY=VALUE without spaces')
 * ...
 */
// require('../lib/helpers/ensure-argv')(argv, 'config')

// Add the CLI ENV arguments
if (argv._ && Array.isArray(argv._)) {
  env.batchUpdate(argv._)
}

let allEnvVars = env.getAll(argv.verbose, argv.all)

allEnvVars.forEach((envValue)=>{
  console.log(envValue)
})
console.log()
